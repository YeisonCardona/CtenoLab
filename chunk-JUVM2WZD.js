import{a as U}from"./chunk-ZXYJ7DLS.js";import{c as A}from"./chunk-4PHGQJCB.js";import{a as R,b as V,c as j,d as N}from"./chunk-2PF4VZYY.js";import{k as H}from"./chunk-FNTTNCNS.js";import{h as E,k as L,l as q,m as B}from"./chunk-2TMWR2NM.js";import{m as T}from"./chunk-2UE2V2R5.js";import{c as I}from"./chunk-XRGWM46W.js";import{b as D}from"./chunk-EBVX5MXQ.js";import{c as z}from"./chunk-KKFSZARV.js";import{$b as P,Ab as m,Bb as o,Cb as a,Db as O,Mb as c,Sa as r,Yb as l,_b as p,ac as F,db as x,hb as C,ra as d,tb as M,ua as b,ub as y,vb as w,wb as S,yb as _,zb as k}from"./chunk-JNWBK6C6.js";import{i as g,j as h,k as v}from"./chunk-GV7GV3NK.js";function Z(s,e){if(s&1&&(o(0,"mat-form-field",6),O(1,"input",7),a()),s&2){let t=c();l("embedded",t.embedded==="embedded"),r(),m("value",t.spellerValue())}}function $(s,e){if(s&1&&(o(0,"div",8,0)(2,"div",9),p(3),a(),o(4,"div",10),p(5),a()()),s&2){let t=e.$implicit,i=c();l("visible",i.showIcon()[t.class])("embedded",i.embedded==="embedded"),M("cue-key",i.fixClass(t.value))("flicker-frequency",t.value),r(3),P(t.class),r(2),F("",t.value," Hz")}}var n=class n extends j{showIcon=d(Object.fromEntries(this.cues().map(e=>[e.class,!1])));fullWindowLink="/paradigms/ssvep/speller/stimuli";normalWindowLink="/paradigms/ssvep/speller";startCountdownValue=0;flickers=[];generateCuesOnFormUpdate=!0;spellerValue=d("");allowModes=["neurofeedback"];ngOnInit(){return v(this,null,function*(){h(n.prototype,this,"ngOnInit").call(this),this.stimuliMode.set("neurofeedback"),yield this.hardwareService.writeLine("CMD=@CLA;"),yield this.hardwareService.writeLine('CMD=@TITLE TEXT="SSVEP Speller" COLOR=BLUE SIZE=3;')})}generateCues(){let e=this.experimentConfig.refresh_rate,t=this.experimentConfig.min_frequency||12,i=this.experimentConfig.max_frequency||120,J=Object.keys(this.stimulusCommandMap).length,u=[],G=this.generateFrequencies(e,t,i),f=0;for(let[X,K]of Object.entries(this.stimulusCommandMap))u.push({class:X,value:G[f]?.toString()??"??"}),f++;this.cues.set(u)}generateTrials(){return[]}setFlickers(){let e=this.experimentConfig.refresh_rate;this.flickers=[],this.cuesDivElement.forEach(t=>{let i=Number(t.nativeElement.getAttribute("flicker-frequency"));this.flickers.push(new U(t,i,e))})}showTrial(e){this.showIcon.set(Object.fromEntries(this.cues().map(t=>[t.class,t.class===e]))),e!==null&&this.spellerValue.set(this.spellerValue()+e)}stopStimuliSequence(){this.flickers.forEach(e=>e.stop())}runStimuliSequence(){this.spellerValue.set(""),this.setFlickers(),this.flickers.forEach(e=>e.start())}static \u0275fac=(()=>{let e;return function(i){return(e||(e=b(n)))(i||n)}})();static \u0275cmp=x({type:n,selectors:[["app-stimuli"]],features:[C],decls:6,vars:7,consts:[["cueElement",""],[3,"hostRef","showCrossBar"],[1,"grid-wrapper"],["appearance","fill",1,"input-line",3,"embedded"],[1,"grid-container"],[1,"cue","flicker","grid-item",3,"visible","embedded"],["appearance","fill",1,"input-line"],["matInput","","placeholder","","readonly","true",3,"value"],[1,"cue","flicker","grid-item"],[1,"speller-cue"],[1,"speller-freq"]],template:function(t,i){t&1&&(o(0,"app-stimuli-layout",1)(1,"div",2),y(2,Z,2,3,"mat-form-field",3),o(3,"div",4),_(4,$,6,8,"div",5,S),a()()()),t&2&&(m("hostRef",i)("showCrossBar",!1),r(),l("embedded",i.embedded==="embedded"),r(),w(i.stimuliMode()==="neurofeedback"?2:-1),r(),l("embedded",i.embedded==="embedded"),r(),k(i.cues()))},dependencies:[I,R,D,A,H,N,z,B,q,E,L,T],styles:[":root{--mat-form-field-filled-active-indicator-height: 0;--mat-form-field-filled-focus-active-indicator-height: 0}.grid-wrapper[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(10,minmax(100px,1fr));gap:70px;padding:16px;max-width:90vw;width:100%}.grid-item[_ngcontent-%COMP%]{aspect-ratio:1/1;width:100%;background-color:var(--mat-sys-inverse-on-surface);display:grid;align-items:center;justify-content:center;border-radius:8px;font-weight:700}.speller-cue[_ngcontent-%COMP%]{color:color-mix(in srgb,var(--mat-sys-primary) 50%,transparent);font-size:2rem;text-align:center}.speller-freq[_ngcontent-%COMP%]{color:color-mix(in srgb,var(--mat-sys-primary) 50%,transparent);font-weight:400;font-size:.7rem}.grid-wrapper.embedded[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{grid-template-columns:repeat(10,minmax(60px,1fr));gap:20px;width:90%}.input-line[_ngcontent-%COMP%]{width:80vh;margin-top:64px;position:absolute;top:16px}.input-line.embedded[_ngcontent-%COMP%]{width:80%;margin-top:0}.input-line[_ngcontent-%COMP%]   .mat-mdc-form-field-focus-overlay[_ngcontent-%COMP%]{border:5px solid var(--mat-sys-error);box-sizing:border-box}.mdc-text-field--filled[_ngcontent-%COMP%]{border-top-left-radius:8px!important;border-top-right-radius:8px!important}.cue.visible[_ngcontent-%COMP%]{border:5px solid var(--mat-sys-error);box-sizing:border-box}"]})};g([V("TRIAL",{arguments:["CLASS"],example:"Trial Target",description:"Highlights the specified class by activating its visual icon while deactivating all others. Useful for indicating the target class during a trial or cue presentation."})],n.prototype,"showTrial",1);var W=n;export{W as a};
