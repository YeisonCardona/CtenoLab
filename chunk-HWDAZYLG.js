import{a as W,b as q,c as Y,d as K,e as G,f as X}from"./chunk-5CXAEJ7B.js";import{f as $}from"./chunk-RQKQH3A5.js";import"./chunk-WEYQENMQ.js";import"./chunk-Y4B7X4IE.js";import{a as L,b as j}from"./chunk-K77XTVW7.js";import{a as V,b as Q}from"./chunk-EBBB7BRD.js";import{e as U}from"./chunk-VYOLDMIK.js";import{a as I,b}from"./chunk-B5VUIIU2.js";import{c as z}from"./chunk-LA5QBKYI.js";import{l as B,o as H}from"./chunk-P5KY7ZS5.js";import{Ab as l,Ad as F,Cb as M,Eb as D,Fb as d,Oa as x,Ra as s,Tb as i,Ub as P,Vb as m,Wa as y,Y as g,Zb as N,bb as _,cb as v,fa as w,ga as C,kc as A,rb as u,sb as f,tb as S,vb as T,wb as E,xb as p,yb as r,zb as n}from"./chunk-5UYQKNNI.js";import"./chunk-VEDDZ7KK.js";import{i as k}from"./chunk-5KHZBZE7.js";var J=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=v({type:t});static \u0275inj=g({imports:[U]})}return t})();var Z=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=v({type:t});static \u0275inj=g({imports:[F,J,F]})}return t})();var R=class t{constructor(o){this.supabaseService=o}amount;userId;tier;container;srcPaypal="";paypalColor="";genUniqueInvoice(){return this.tier+"-"+Math.random().toString(36).substring(2,165)}ngOnInit(){this.supabaseService.userTier()==="Developer"?(this.srcPaypal="https://www.sandbox.paypal.com/sdk/js?client-id="+I.sandbox+"&currency=USD",this.paypalColor="gold"):(this.srcPaypal="https://www.paypal.com/sdk/js?client-id="+I.production+"&currency=USD",this.paypalColor="white")}ngAfterViewInit(){return k(this,null,function*(){try{yield this.loadPayPalScript(),yield this.waitForPaypal(),paypal.Buttons({style:{layout:"horizontal",color:this.paypalColor,shape:"pill",label:"pay",tagline:!1},createOrder:(o,e)=>e.order.create({purchase_units:[{amount:{value:this.amount},custom_id:this.userId,invoice_id:this.genUniqueInvoice()}]}),onApprove:(o,e)=>k(this,null,function*(){let c=`Payment successful! Thank you, ${(yield e.order.capture()).payer.name.given_name}. Your access tier will be updated automatically in a few moments.`;["pro","researcher"].includes(this.tier.toLowerCase())&&(c+=" Hardware included in your plan will be shipped to the address specified in your PayPal account."),alert(c)})}).render("#"+this.container)}catch(o){console.error("PayPal initialization failed:",o)}return null})}loadPayPalScript(){return new Promise((o,e)=>{if(document.getElementById("paypal-sdk"))return o();let a=document.createElement("script");a.id="paypal-sdk",a.src=this.srcPaypal,a.onload=()=>o(),a.onerror=()=>e("Failed to load PayPal SDK"),document.body.appendChild(a)})}waitForPaypal(){return new Promise((o,e)=>{let a=setInterval(()=>{typeof window<"u"&&window.paypal&&this.userId&&this.userId.length>5&&(clearInterval(a),o())},50);setTimeout(()=>{clearInterval(a),e("PayPal SDK did not initialize in time.")},3e3)})}static \u0275fac=function(e){return new(e||t)(y(b))};static \u0275cmp=_({type:t,selectors:[["app-paypal"]],inputs:{amount:"amount",userId:"userId",tier:"tier",container:"container"},decls:1,vars:2,consts:[[3,"id"]],template:function(e,a){e&1&&l(0,"div",0),e&2&&p("id",N(a.container))},encapsulation:2})};function he(t,o){if(t&1){let e=M();r(0,"h1"),i(1,"Welcome, Researcher"),n(),r(2,"p"),i(3,"Please sign in with your preferred method."),n(),r(4,"div",0)(5,"button",1),D("click",function(){w(e);let c=d();return C(c.supabaseService.signInWithProvider("google"))}),l(6,"i",2),i(7," Log in using Google "),n(),r(8,"button",1),D("click",function(){w(e);let c=d();return C(c.supabaseService.signInWithProvider("github"))}),l(9,"i",3),i(10," Log in using GitHub "),n()()}}function pe(t,o){if(t&1&&(r(0,"p")(1,"b"),i(2,"License Tier:"),n(),i(3),l(4,"br"),r(5,"b"),i(6,"Issued at:"),n(),i(7),l(8,"br"),r(9,"b"),i(10,"Expires at:"),n(),i(11),l(12,"br"),r(13,"b"),i(14,"Remaining days:"),n(),i(15),l(16,"br"),n()),t&2){let e,a,c,h=d(2);s(3),m(" ",(e=h.supabaseService.userLicense())==null?null:e.tier),s(4),m(" ",(a=h.supabaseService.userLicense())==null?null:a.issued_at),s(4),m(" ",(c=h.supabaseService.userLicense())==null?null:c.expires_at),s(4),m(" ",h.getRemainingDays())}}function ye(t,o){t&1&&(r(0,"p"),i(1," Your account does not have an active license."),l(2,"br"),i(3," Please redeem or purchase a license to unlock full access. "),n())}function _e(t,o){t&1&&(r(0,"p"),i(1," You are currently subscribed to the "),r(2,"strong"),i(3,"Enterprise plan"),n(),i(4," \u2014 our most advanced tier. "),l(5,"br"),i(6," You have full access to all experiments, hardware features, and dedicated support. "),n())}function ge(t,o){t&1&&(r(0,"p"),i(1,"Select the plan that best fits your needs."),n())}function we(t,o){if(t&1&&l(0,"li",10),t&2){let e=o.$implicit;p("innerHTML",e,x)}}function Ce(t,o){if(t&1&&l(0,"p",10),t&2){let e=d().$implicit;p("innerHTML",e.note,x)}}function ve(t,o){t&1&&(r(0,"strong",12),i(1,"Shipping Notice:"),n(),r(2,"p"),i(3," We will use your "),r(4,"b"),i(5,"PayPal shipping address"),n(),i(6," for the delivery of any hardware included in your plan. "),l(7,"br"),i(8," Please make sure your address is "),r(9,"b"),i(10,"correct and up-to-date"),n(),i(11," before completing the payment. "),n())}function De(t,o){if(t&1&&l(0,"app-paypal",13),t&2){let e=d(2).$implicit,a=d(2);p("amount",e.amount)("tier",e.tier)("userId",a.supabaseService.userId())("container",e.tier)}}function be(t,o){if(t&1&&(r(0,"div",11),u(1,De,1,4,"app-paypal",13),n()),t&2){let e=d().$implicit;s(),f(e.amount>0?1:-1)}}function Re(t,o){if(t&1&&(r(0,"mat-expansion-panel",9)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),i(3),n(),r(4,"mat-panel-description"),i(5),n()(),r(6,"ul"),T(7,we,1,1,"li",10,S),n(),u(9,Ce,1,1,"p",10),r(10,"h3"),i(11),n(),u(12,ve,12,0),u(13,be,2,1,"div",11),n()),t&2){let e=o.$implicit,a=o.$index,c=d(2);p("expanded",a===0),s(3),m(" ",e.title," "),s(2),m(" ",e.summary," "),s(2),E(e.details),s(2),f(e.note?9:-1),s(2),P(e.amountVerbose),s(),f(c.supabaseService.getTierLevel(e.tier)>=3?12:-1),s(),f(c.supabaseService.userId()?13:-1)}}function ke(t,o){t&1&&(l(0,"mat-divider"),r(1,"div",6)(2,"h3",14),i(3,"Request a Custom Experiment"),n(),r(4,"p"),i(5," If you require a specialized experimental design, I\u2019ll be happy to provide personalized support. "),l(6,"br"),i(7," Just write to me at "),r(8,"a",15),i(9,"cteno@dunderlab.com"),n(),i(10," and I\u2019ll get back to you promptly. "),n()())}function xe(t,o){if(t&1){let e=M();r(0,"h1"),i(1),n(),r(2,"p"),i(3,"You are now signed in to your researcher dashboard."),n(),r(4,"div",4)(5,"button",5),D("click",function(){w(e);let c=d();return C(c.supabaseService.signOut())}),i(6,"Sign out"),n()(),l(7,"mat-divider"),u(8,pe,17,4,"p")(9,ye,4,0,"p"),l(10,"mat-divider"),r(11,"div",6)(12,"h3",7),i(13,"Update Your Tier"),n(),u(14,_e,7,0,"p")(15,ge,2,0,"p"),r(16,"mat-accordion",8),T(17,Re,14,7,"mat-expansion-panel",9,S),n()(),u(19,ke,11,0)}if(t&2){let e=d();s(),m("Welcome back, ",e.supabaseService.userMail(),"!"),s(7),f(e.supabaseService.licenseActive()?8:9),s(6),f(e.supabaseService.userTier()==="Enterprise"?14:15),s(3),E(e.tiersToShow()),s(2),f(e.supabaseService.getTierLevel(e.supabaseService.userTier())>=e.supabaseService.getTierLevel("Pro")?19:-1)}}var ee=class t{constructor(o,e,a){this.navigationService=o;this.breadcrumbService=e;this.supabaseService=a;o.setActiveLink("/experiments"),this.breadcrumbService.setBreadcrumbs([{label:"Home",url:"/home"},{label:"User",url:"/user"}])}userId=null;tiers=["Basic","Hobbyist","Researcher","Pro","Enterprise"];ngAfterViewInit(){}getRemainingDays(){let o=this.supabaseService.userLicense()?.expires_at,e=new Date,c=new Date(o).getTime()-e.getTime(),h=Math.ceil(c/(1e3*60*60*24));return h>=0?h:0}tiersToShow=A(()=>{let o=this.tiers.indexOf(this.supabaseService.userTier());return this.allTiers.slice(o+1)});allTiers=[{title:"Basic",price:"Free",summary:"Initial exploration without hardware.",details:["Access to basic BCI experiments only","Essential experimental controls","<b>No hardware synchronization</b>"],note:"",amount:0,amountVerbose:"Free",tier:"Basic",button:"Start for Free"},{title:"Hobbyist",price:"for $7 per month",summary:"Monthly access for enthusiasts.",details:["Access to all BCI paradigms","Advanced experimental controls","<b>No hardware synchronization</b>","<b>Personal use only</b>"],note:"This plan does not renew automatically. Manual renewal is required each month.",amount:7,amountVerbose:"$7 / month",tier:"Hobbyist"},{title:"Researcher",price:"for $49 per year",summary:"Annual license without hardware.",details:["Access to all BCI paradigms","Advanced experimental controls","<b>No hardware synchronization</b>","<b>Personal or academic use only</b>"],note:"This plan does not include synchronization hardware. Ideal for offline or analysis-only research workflows.",amount:49,amountVerbose:"$49 / year",tier:"Researcher"},{title:"Pro",price:"for $549 per year",summary:"Full solution with hardware shipped.",details:["Access to full experiment library","<b>Includes synchronization hardware</b>","<b>Worldwide shipping included</b>","<b>Real-time event triggers</b>","<b>Research-grade deployment ready</b>"],note:"Your synchronization hardware will be shipped after purchase. Worldwide delivery included at no extra cost.",amount:549,amountVerbose:"$549 / year",tier:"Pro"},{title:"Enterprise",price:"for $3200<sup>*</sup> per year",summary:"Full access + Custom experiment.",details:["All Pro-tier features included","<b>One month of dedicated development</b>","<b>Custom paradigm design</b>","<b>Priority support & consulting</b>","<b>Tailored enterprise protocols</b>","<b>Worldwide shipping of hardware</b>"],note:"*Includes the full design and development of one (1) customized experimental paradigm tailored to your needs.",amount:3200,amountVerbose:"$3200 / year",tier:"Enterprise"}];static \u0275fac=function(e){return new(e||t)(y(V),y(Q),y(b))};static \u0275cmp=_({type:t,selectors:[["app-user"]],decls:2,vars:1,consts:[[1,"flex-row"],["matButton","filled",1,"logbutton",3,"click"],[1,"devicon","devicon-google-plain"],[1,"devicon","devicon-github-original"],[1,"flex-row","margin-bottom-large"],["matButton","filled",1,"error",3,"click"],[1,"margin-top-large","margin-bottom-large"],[1,"no-margin-bottom"],["multi",""],["hideToggle","",3,"expanded"],[3,"innerHTML"],[1,"paypal-container"],[1,"shipping"],[3,"amount","tier","userId","container"],["id","request",1,"no-margin-bottom"],["href","mailto:cteno@dunderlab.com"]],template:function(e,a){e&1&&u(0,he,11,0)(1,xe,20,4),e&2&&f(a.supabaseService.userLogged()?1:0)},dependencies:[z,j,L,H,B,Z,R,X,G,W,q,K,Y,$],styles:[".paypal-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:1rem}app-paypal[_ngcontent-%COMP%]{width:40%}.shipping[_ngcontent-%COMP%]{color:var(--mat-sys-error);font-weight:700}"]})};export{ee as User};
