import{a as ne}from"./chunk-V44FAVNM.js";import{a as Y,b as ee,c as te,d as ie,e as ae,f as re}from"./chunk-A7C4BLDY.js";import{k as X}from"./chunk-DUXI72MP.js";import{b as J,c as Q}from"./chunk-YGJZO764.js";import"./chunk-FDI5VVZL.js";import{a as q}from"./chunk-TC42CYHG.js";import"./chunk-5E6RAWY4.js";import"./chunk-4PHGQJCB.js";import"./chunk-S752GWJP.js";import{c as Z}from"./chunk-FNTTNCNS.js";import"./chunk-JQYROLX5.js";import{a as G,b as K,f as N}from"./chunk-5ZKSSP3E.js";import"./chunk-IXPZEY46.js";import"./chunk-DIONBDFX.js";import{a as L,b as O}from"./chunk-OAVLZCYW.js";import{b as z}from"./chunk-T26HEB2W.js";import"./chunk-NP432326.js";import"./chunk-2UE2V2R5.js";import"./chunk-Q7G7UQXQ.js";import{b as W}from"./chunk-H53LNFG5.js";import"./chunk-VVJ3YVZY.js";import"./chunk-O3YAIXEY.js";import{b as B}from"./chunk-XRGWM46W.js";import"./chunk-EBVX5MXQ.js";import{a as j}from"./chunk-TLAT6ZHR.js";import{h as U}from"./chunk-6MKFGCP3.js";import"./chunk-ZJIUVY4T.js";import"./chunk-CR4H4DNL.js";import"./chunk-WDA2SWQK.js";import"./chunk-EVU24ONZ.js";import{a as I,c as $}from"./chunk-JW5YZPO3.js";import{i as F,k as H,n as A}from"./chunk-NRSOVIAX.js";import{m as E}from"./chunk-4SNU4EVC.js";import{$b as R,Ab as m,Bb as o,Cb as l,Db as p,Hb as P,Lb as y,Mb as D,Pa as _,Qa as S,Sa as s,Xa as d,_b as c,bc as x,db as k,ga as b,gc as V,ha as g,hb as C,sc as M,ub as T,vb as w}from"./chunk-JNWBK6C6.js";import"./chunk-GV7GV3NK.js";function le(h,oe){if(h&1&&p(0,"app-diagram",6),h&2){let i=D();m("diagram",i.diagram())}}var se=class h extends re{constructor(i,t,e,n,a,r,u){super(i,t,e,n,a);this.navigationService=r;this.breadcrumbService=u;this.navigationService.setActiveLink("/paradigms/p300/rsvp-speller"),this.breadcrumbService.setBreadcrumbs([{label:"Home",url:"/home"},{label:"Paradigms",url:"/paradigms"},{label:"P300",url:"/paradigms/p300"},{label:"RSVP Speller",url:"/paradigms/p300/rsvp-speller"}])}requieredTier="Basic";storageKey="rsvp-speller-p300";resetValues(){this.formData.set({flash_duration:125,target_duration:1e3,target_probability:10,repetitions_per_target:300,soa_inter_trial:200,soa_intra_trial:1e3,target_characters:15})}summary=M(()=>{let i=this.formData();if(!i||Object.keys(i).length===0)return"";let t=[],e=i.target_characters,n=i.soa_inter_trial,a=Math.round(((i.flash_duration+i.soa_inter_trial)*i.repetitions_per_target*e+i.target_duration*e+i.soa_intra_trial*e)/6e4);e>1e3&&t.push("The total number of trials exceeds 1000. This may lead to participant fatigue."),a>30&&t.push("Estimated experiment duration exceeds 30 minutes. Consider reducing trials or stimulus duration.");let r=t.length?`<p class="warning"><b>\u26A0\uFE0F Warnings:</b><br>${t.map(u=>`\u2022 ${u}`).join("<br>")}</p>`:"";return`
    <p class="summary-block">
      <b>Total trials</b>: ${e}<br>
      <b>Stimulus duration</b>: ${i.flash_duration} ms<br>
      <b>SOA</b>: ${n} ms<br>
      <b>Estimated duration</b>: ${a} min
    </p>
    ${r}
  `});experiment={name:"RSVP Speller",description:"This experiment implements a <b>Rapid Serial Visual Presentation (RSVP)</b> paradigm in which stimuli (e.g., letters or symbols) are displayed <b>sequentially and rapidly</b> at the center of the screen. Participants focus attention on a pre-specified target as it appears in the stream, eliciting a characteristic <b>P300 response</b> observable in EEG signals. This design minimizes eye movements and supports <b>sequential spelling</b> in BCI systems.",objective:"The objective of this experiment is to assess the ability to <b>detect attention-driven event-related potentials (ERPs)</b>, specifically the <b>P300 component</b>, in response to <b>target stimuli</b> embedded in a rapid visual stream. By isolating the neural response to attended stimuli, this paradigm enables <b>reliable character selection</b> using brain signals in a BCI spelling interface.",procedure:"Participants are instructed to focus on a specific <b>target character or symbol</b> that will appear among a stream of <b>non-targets</b> presented one at a time at the center of the screen. Each trial begins with a brief <b>fixation period</b>, followed by the <b>RSVP sequence</b> where all possible options are flashed in random order. Each stimulus is shown for a short duration (typically <b>100\u2013200 ms</b>), with a brief inter-stimulus interval (<b>SOA</b>). The <b>target item</b> is embedded multiple times in the stream to enhance ERP detection. EEG data is recorded continuously and time-locked to each stimulus onset. A complete session includes <b>multiple repetitions per target</b>, typically lasting <b>20\u201330 minutes</b>."};stimulusCommandMap={Dog:"d",Cat:"c",Elephant:"e",Tiger:"t",Lion:"l",Giraffe:"g",Monkey:"m",Zebra:"z",Penguin:"p",Bear:"b",Kangaroo:"k",Koala:"a",Panda:"n",Wolf:"w",Fox:"f",Hippopotamus:"h",Rhinoceros:"r",Cheetah:"v",Gorilla:"i",Dolphin:"o",Target:"*t",NonTarget:"*n",Feedback:"*f"};animals=["Dog","Cat","Elephant","Tiger","Lion","Giraffe","Monkey","Zebra","Penguin","Bear","Kangaroo","Koala","Panda","Wolf","Fox","Hippopotamus","Rhinoceros","Cheetah","Gorilla","Dolphin"];formField=[{type:"checkbox",key:"categories",label:"Semantic Categories",value:this.animals,options:this.animals,hint:"Select the semantic categories to be used as stimuli in the experiment"},{type:"slider",key:"flash_duration",label:"Flash Duration",value:125,min:10,max:1e3,step:1,suffix:"ms",hint:""},{type:"slider",key:"target_duration",label:"Target Duration",value:1e3,min:500,max:2e3,step:1,suffix:"ms",hint:""},{type:"slider",key:"target_probability",label:"Target",value:10,min:1,max:100,step:1,suffix:"%",hint:""},{type:"slider",key:"repetitions_per_target",label:"Repetitions per Target",value:300,min:1,max:1e3,step:1,suffix:"times",hint:""},{type:"slider",key:"soa_inter_trial",label:"Inter-Trial SOA (ms)",value:200,min:0,max:1e3,step:1,suffix:"ms",hint:""},{type:"slider",key:"soa_intra_trial",label:"Intra-Trial SOA (ms)",value:1e3,min:100,max:2e3,step:10,suffix:"ms",hint:""},{type:"slider",key:"target_characters",label:"Target Characters",value:15,min:1,max:50,step:1,suffix:"chars",hint:""}];diagram=M(()=>{let t=this.formData();if(Object.keys(t).length===0)return{height:"0",blocks:[]};let e=t.target_duration+t.flash_duration*5+t.soa_inter_trial*5+t.soa_intra_trial,n=t.target_duration/e*100,a=t.flash_duration/e*100,r=t.soa_inter_trial/e*100,u=t.soa_intra_trial/e*100,f=[{name:"soa",label:`Stimulus Onset Asynchonously<br>Randomized Delay: ${t.soa_intra_trial} ms`,width:`${u}%`},{name:"cue2",label:`Target Presentation<br>Duration: ${t.target_duration} ms`,left:`${u}%`,width:`${n}%`},{name:"marker",label:"Marker Encoding<br>(Synchronization Trigger)",bottom:"205px",left:`${u}%`,width:`${n}%`,height:"50px"}];for(let v=0;v<5;v++)f.push({name:"cue",label:"Column or Row Activation",left:`${u+n+(r+a)*v}%`,width:`${a}%`,vertical:!0}),f.push({name:"soa",label:"Inter-Stimulus Asynchrony",left:`${u+n+a+(r+a)*v}%`,width:`${r}%`,vertical:!0}),f.push({name:"marker",label:"Marker",bottom:"205px",left:`${u+n+(r+a)*v}%`,width:`${a+r}%`,height:"50px"});return f.push(),{height:"250px",blocks:f.flat(),context:""}});static \u0275fac=function(t){return new(t||h)(d(I),d($),d(W),d(Z),d(z),d(L),d(O))};static \u0275cmp=k({type:h,selectors:[["app-rsvp-speller"]],features:[C],decls:43,vars:26,consts:[["taskPanel",""],["tabGroup",""],["formComponent",""],[1,"no-margin-bottom"],[1,"align-justify",3,"innerHTML"],[1,"grid-responsive-2"],[3,"diagram"],["dynamicHeight","","mat-stretch-tabs","","animationDuration","100ms",1,"example-stretched-tabs","mat-elevation-z4"],["label","Stimuli Delivery"],[1,"margin-bottom-small"],[3,"valueChange","config","columns","storageKey"],[1,"margin-top-large",3,"innerHTML"],[1,"flex-row","flex-row-left"],[1,"elipsis-96",3,"href"],["matIconButton","",3,"cdkCopyToClipboard"],["matButton","filled",1,"margin-top-large","margin-bottom-large",3,"click"],[3,"commandRegistry","experimentConfig","embedded","stimulusCommandMap","stimulusMarkersMap"],["label","Markers Generation"],[1,"margin-top-large"],[3,"stimulusMarkersMapData","stimulusMarkersMap","stimulusCommandMap"],["label","Neurofeedback & Runtime Events"],[3,"commandRegistryMap","stimulusCommandMap","hardwareIP"],["label","Specification"],[3,"stimulusMarkersMapData","experimentConfig","stimuli_delivery_link"]],template:function(t,e){if(t&1){let n=P();o(0,"div",null,0)(2,"h1",3),c(3),l(),p(4,"p",4),o(5,"div",5)(6,"div")(7,"h2",3),c(8,"Objective"),l(),p(9,"p",4),l(),o(10,"div")(11,"h2",3),c(12,"Procedure"),l(),p(13,"p",4),l()(),T(14,le,1,1,"app-diagram",6),p(15,"mat-divider"),o(16,"mat-tab-group",7,1)(18,"mat-tab",8),p(19,"div",9),o(20,"app-inputs",10,2),y("valueChange",function(r){return b(n),g(e.onFormValueChange(r))}),l(),p(22,"div",11),o(23,"p",12)(24,"span")(25,"b"),c(26,"Direct experiment link:"),l()(),o(27,"a",13),c(28),l(),o(29,"button",14)(30,"mat-icon"),c(31,"content_copy"),l()()(),o(32,"button",15),y("click",function(){return b(n),g(e.loadDefaultValues())}),c(33,"Load Default Values"),l(),o(34,"app-stimuli",16),y("commandRegistry",function(r){return b(n),g(e.setCommandRegistry(r))}),l()(),o(35,"mat-tab",17),p(36,"div",18),o(37,"app-markers",19),y("stimulusMarkersMapData",function(r){return b(n),g(e.setStimulusMarkersMapData(r))})("stimulusMarkersMap",function(r){return b(n),g(e.setStimulusMarkersMap(r))}),l()(),o(38,"mat-tab",20),p(39,"app-layout-commands",21),l(),o(40,"mat-tab",22),p(41,"div",18)(42,"app-specification",23),l()()()}t&2&&(s(3),R(e.experiment.name),s(),m("innerHTML",e.experiment.description,_),s(5),m("innerHTML",e.experiment.objective,_),s(4),m("innerHTML",e.experiment.procedure,_),s(),w(e.diagram()?14:-1),s(6),m("config",e.formField)("columns",e.columns)("storageKey",e.storageKey),s(2),m("innerHTML",e.summary(),_),s(5),m("href",V("",e.currentUrl,"",e.getFullWindowLink("/stimuli")),S),s(),x(" ",e.currentUrl,"",e.getFullWindowLink("/stimuli")," "),s(),m("cdkCopyToClipboard",e.currentUrl+e.getFullWindowLink("/stimuli")),s(5),m("experimentConfig",e.formData())("embedded","embedded")("stimulusCommandMap",e.stimulusCommandMap)("stimulusMarkersMap",e.stimulusMarkersMap),s(3),m("stimulusCommandMap",e.stimulusCommandMap),s(2),m("commandRegistryMap",e.commandRegistry)("stimulusCommandMap",e.stimulusCommandMap)("hardwareIP",e.hardwareService.hardwareIP()),s(3),m("stimulusMarkersMapData",e.stimulusMarkersMapData)("experimentConfig",e.formData)("stimuli_delivery_link",e.currentUrl+e.getFullWindowLink("/stimuli")))},dependencies:[ne,E,N,G,K,B,Y,A,H,F,Q,J,X,ee,U,q,j,ie,te,ae],encapsulation:2})};export{se as P300RSVPSpeller};
