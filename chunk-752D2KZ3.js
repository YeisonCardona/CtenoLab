import{a as N}from"./chunk-267TKMII.js";import{c as B}from"./chunk-4PHGQJCB.js";import{a as P,c as A,d as z}from"./chunk-4H2BPYRN.js";import{c as j,k as H}from"./chunk-FNTTNCNS.js";import{b as O}from"./chunk-RRXYPN2E.js";import{b as D}from"./chunk-H53LNFG5.js";import{a as _}from"./chunk-O3YAIXEY.js";import{c as F}from"./chunk-XRGWM46W.js";import{b as L}from"./chunk-EBVX5MXQ.js";import{c as q}from"./chunk-KKFSZARV.js";import{a as E,c as R}from"./chunk-JW5YZPO3.js";import{Ab as y,Bb as l,Cb as u,Mb as M,Sa as c,Xa as r,Yb as T,_b as b,ac as k,db as v,hb as h,ra as g,tb as S,tc as I,wb as C,yb as x,zb as w}from"./chunk-JNWBK6C6.js";import{j as p,k as f}from"./chunk-GV7GV3NK.js";function U(o,d){if(o&1&&(l(0,"div",4,0),b(2),u()),o&2){let e=d.$implicit,t=M();S("cue-key",t.fixClass(e.value))("flicker-frequency",e.value),c(2),k(" ",e.value," Hz ")}}var V=class o extends A{constructor(e,t,i,a,s,m){super(e,t,i,a,s,m);this.hardwareService=a;this.dialog=s;this.supabaseService=m;I(()=>{let n=this.formData();this.generateCues()})}showIcon=g(Object.fromEntries(this.cues().map(e=>[e.class,!1])));fullWindowLink="/paradigms/ssvep/tuning/stimuli";normalWindowLink="/paradigms/ssvep/tuning";startCountdownValue=0;flickers=[];ngOnInit(){return f(this,null,function*(){p(o.prototype,this,"ngOnInit").call(this),yield this.hardwareService.writeLine("CMD=@CLA;"),yield this.hardwareService.writeLine('CMD=@TITLE TEXT="SSVEP Frequency Tuning" COLOR=BLUE SIZE=3;')})}generateCues(){let e=this.experimentConfig.refresh_rate,t=this.experimentConfig.min_frequency||12,i=this.experimentConfig.max_frequency||120,a=this.experimentConfig.count||4,s=[],m=(i-t)/(a-1);for(let n=0;n<a;n++){let W=t+m*n,$=Math.round(e/W),G=e/$;s.push({class:`Target ${n}`,value:G.toFixed(2)})}this.cues.set(s)}generateTrials(){return[]}setFlickers(){let e=this.experimentConfig.refresh_rate;this.flickers=[],this.cuesDivElement.forEach(t=>{let i=Number(t.nativeElement.getAttribute("flicker-frequency"));this.flickers.push(new N(t,i,e))})}showTrial(e){}stopStimuliSequence(){this.flickers.forEach(e=>e.stop())}runStimuliSequence(){console.log("START"),this.setFlickers(),this.flickers.forEach(e=>e.start())}static \u0275fac=function(t){return new(t||o)(r(E),r(_),r(R),r(O),r(j),r(D))};static \u0275cmp=v({type:o,selectors:[["app-stimuli"]],features:[h],decls:5,vars:3,consts:[["cueElement",""],[3,"hostRef"],[1,"grid-wrapper"],[1,"grid-container"],[1,"cue","flicker","grid-item"]],template:function(t,i){t&1&&(l(0,"app-stimuli-layout",1)(1,"div",2)(2,"div",3),x(3,U,3,3,"div",4,C),u()()()),t&2&&(y("hostRef",i),c(),T("embedded",i.embedded==="embedded"),c(2),w(i.cues()))},dependencies:[F,P,L,B,H,z,q],styles:[".grid-wrapper[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:120px;padding:16px;max-width:90vw;width:100%}.grid-item[_ngcontent-%COMP%]{aspect-ratio:1/1;width:100%;background-color:var(--mat-sys-inverse-on-surface);display:flex;align-items:center;justify-content:center;border-radius:8px;font-weight:700;color:color-mix(in srgb,var(--mat-sys-primary) 30%,transparent)}.grid-wrapper.embedded[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(60px,1fr));gap:20px;width:90%}"]})};export{V as a};
