import{a as W,b as q,c as Y,d as K,e as G,f as X}from"./chunk-BYFEE2BT.js";import{f as V}from"./chunk-C326EY35.js";import"./chunk-AV57WIB4.js";import"./chunk-HRYCUA6K.js";import{a as H,b as z}from"./chunk-J7R32EXU.js";import{a as j,b as U}from"./chunk-FNZD6ZPB.js";import{e as L}from"./chunk-PGXIVTLU.js";import{a as Q,b as $}from"./chunk-36YKBAEN.js";import{c as B}from"./chunk-BN5QOK7L.js";import{l as N,o as A}from"./chunk-EXEM6OM4.js";import{ca as M}from"./chunk-RWQLXEFD.js";import{Ab as p,Bb as r,Cb as n,Db as l,Fb as E,Jb as D,Kb as d,Pa as k,Sa as s,Xa as C,Yb as i,Z as _,Zb as I,_b as m,db as y,eb as v,fc as O,ga as g,ha as w,tc as P,ub as u,vb as f,wb as x,yb as S,zb as T}from"./chunk-FHWKK7EC.js";import"./chunk-VEDDZ7KK.js";import{i as R}from"./chunk-5KHZBZE7.js";var J=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=v({type:t});static \u0275inj=_({imports:[L]})}return t})();var Z=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=v({type:t});static \u0275inj=_({imports:[M,J,M]})}return t})();var b=class t{amount;userId;tier;container;genUniqueInvoice(){return this.tier+"-"+Math.random().toString(36).substring(2,165)}ngAfterViewInit(){return R(this,null,function*(){try{yield this.loadPayPalScript(),yield this.waitForPaypal(),paypal.Buttons({style:{layout:"horizontal",color:"white",shape:"pill",label:"pay",tagline:!1},createOrder:(o,e)=>e.order.create({purchase_units:[{amount:{value:this.amount},custom_id:this.userId,invoice_id:this.genUniqueInvoice()}]}),onApprove:(o,e)=>R(this,null,function*(){let c=`Payment successful! Thank you, ${(yield e.order.capture()).payer.name.given_name}. Your access tier will be updated automatically in a few moments.`;["pro","researcher"].includes(this.tier.toLowerCase())&&(c+=" Hardware included in your plan will be shipped to the address specified in your PayPal account."),alert(c)})}).render("#"+this.container)}catch(o){console.error("PayPal initialization failed:",o)}return null})}loadPayPalScript(){return new Promise((o,e)=>{if(document.getElementById("paypal-sdk"))return o();let a=document.createElement("script");a.id="paypal-sdk",a.src="https://www.sandbox.paypal.com/sdk/js?client-id="+Q.clientId+"&currency=USD",a.onload=()=>o(),a.onerror=()=>e("Failed to load PayPal SDK"),document.body.appendChild(a)})}waitForPaypal(){return new Promise((o,e)=>{let a=setInterval(()=>{typeof window<"u"&&window.paypal&&this.userId&&this.userId.length>5&&(clearInterval(a),o())},50);setTimeout(()=>{clearInterval(a),e("PayPal SDK did not initialize in time.")},3e3)})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-paypal"]],inputs:{amount:"amount",userId:"userId",tier:"tier",container:"container"},decls:1,vars:2,consts:[[3,"id"]],template:function(e,a){e&1&&l(0,"div",0),e&2&&p("id",O(a.container))},encapsulation:2})};function me(t,o){if(t&1){let e=E();r(0,"h1"),i(1,"Welcome, Researcher"),n(),r(2,"p"),i(3,"Please sign in with your preferred method."),n(),r(4,"div",0)(5,"button",1),D("click",function(){g(e);let c=d();return w(c.supabaseService.signInWithProvider("google"))}),l(6,"i",2),i(7," Log in using Google "),n(),r(8,"button",1),D("click",function(){g(e);let c=d();return w(c.supabaseService.signInWithProvider("github"))}),l(9,"i",3),i(10," Log in using GitHub "),n()()}}function he(t,o){if(t&1&&(r(0,"p")(1,"b"),i(2,"License Tier:"),n(),i(3),l(4,"br"),r(5,"b"),i(6,"Issued at:"),n(),i(7),l(8,"br"),r(9,"b"),i(10,"Expires at:"),n(),i(11),l(12,"br"),r(13,"b"),i(14,"Remaining days:"),n(),i(15),l(16,"br"),n()),t&2){let e,a,c,h=d(2);s(3),m(" ",(e=h.supabaseService.userLicense())==null?null:e.tier),s(4),m(" ",(a=h.supabaseService.userLicense())==null?null:a.issued_at),s(4),m(" ",(c=h.supabaseService.userLicense())==null?null:c.expires_at),s(4),m(" ",h.getRemainingDays())}}function pe(t,o){t&1&&(r(0,"p"),i(1," Your account does not have an active license."),l(2,"br"),i(3," Please redeem or purchase a license to unlock full access. "),n())}function ye(t,o){t&1&&(r(0,"p"),i(1," You are currently subscribed to the "),r(2,"strong"),i(3,"Enterprise plan"),n(),i(4," \u2014 our most advanced tier. "),l(5,"br"),i(6," You have full access to all experiments, hardware features, and dedicated support. "),n())}function _e(t,o){t&1&&(r(0,"p"),i(1,"Select the plan that best fits your needs."),n())}function ge(t,o){if(t&1&&l(0,"li",10),t&2){let e=o.$implicit;p("innerHTML",e,k)}}function we(t,o){if(t&1&&l(0,"p",10),t&2){let e=d().$implicit;p("innerHTML",e.note,k)}}function Ce(t,o){t&1&&(r(0,"strong",12),i(1,"Shipping Notice:"),n(),r(2,"p"),i(3," We will use your "),r(4,"b"),i(5,"PayPal shipping address"),n(),i(6," for the delivery of any hardware included in your plan. "),l(7,"br"),i(8," Please make sure your address is "),r(9,"b"),i(10,"correct and up-to-date"),n(),i(11," before completing the payment. "),n())}function ve(t,o){if(t&1&&l(0,"app-paypal",13),t&2){let e=d(2).$implicit,a=d(2);p("amount",e.amount)("tier",e.tier)("userId",a.supabaseService.userId())("container",e.tier)}}function De(t,o){if(t&1&&(r(0,"div",11),u(1,ve,1,4,"app-paypal",13),n()),t&2){let e=d().$implicit;s(),f(e.amount>0?1:-1)}}function be(t,o){if(t&1&&(r(0,"mat-expansion-panel",9)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),i(3),n(),r(4,"mat-panel-description"),i(5),n()(),r(6,"ul"),S(7,ge,1,1,"li",10,x),n(),u(9,we,1,1,"p",10),r(10,"h3"),i(11),n(),u(12,Ce,12,0),u(13,De,2,1,"div",11),n()),t&2){let e=o.$implicit,a=o.$index,c=d(2);p("expanded",a===0),s(3),m(" ",e.title," "),s(2),m(" ",e.summary," "),s(2),T(e.details),s(2),f(e.note?9:-1),s(2),I(e.amountVerbose),s(),f(c.supabaseService.getTierLevel(e.tier)>=3?12:-1),s(),f(c.supabaseService.userId()?13:-1)}}function Re(t,o){t&1&&(l(0,"mat-divider"),r(1,"div",6)(2,"h3",14),i(3,"Request a Custom Experiment"),n(),r(4,"p"),i(5," If you require a specialized experimental design, I\u2019ll be happy to provide personalized support. "),l(6,"br"),i(7," Just write to me at "),r(8,"a",15),i(9,"cteno@dunderlab.com"),n(),i(10," and I\u2019ll get back to you promptly. "),n()())}function ke(t,o){if(t&1){let e=E();r(0,"h1"),i(1),n(),r(2,"p"),i(3,"You are now signed in to your researcher dashboard."),n(),r(4,"div",4)(5,"button",5),D("click",function(){g(e);let c=d();return w(c.supabaseService.signOut())}),i(6,"Sign out"),n()(),l(7,"mat-divider"),u(8,he,17,4,"p")(9,pe,4,0,"p"),l(10,"mat-divider"),r(11,"div",6)(12,"h3",7),i(13,"Update Your Tier"),n(),u(14,ye,7,0,"p")(15,_e,2,0,"p"),r(16,"mat-accordion",8),S(17,be,14,7,"mat-expansion-panel",9,x),n()(),u(19,Re,11,0)}if(t&2){let e=d();s(),m("Welcome back, ",e.supabaseService.userMail(),"!"),s(7),f(e.supabaseService.licenseActive()?8:9),s(6),f(e.supabaseService.userTier()==="Enterprise"?14:15),s(3),T(e.tiersToShow()),s(2),f(e.supabaseService.getTierLevel(e.supabaseService.userTier())>=e.supabaseService.getTierLevel("Pro")?19:-1)}}var ee=class t{constructor(o,e,a){this.navigationService=o;this.breadcrumbService=e;this.supabaseService=a;o.setActiveLink("/experiments"),this.breadcrumbService.setBreadcrumbs([{label:"Home",url:"/home"},{label:"User",url:"/user"}])}userId=null;tiers=["Basic","Hobbyist","Researcher","Pro","Enterprise"];ngAfterViewInit(){}getRemainingDays(){let o=this.supabaseService.userLicense()?.expires_at,e=new Date,c=new Date(o).getTime()-e.getTime(),h=Math.ceil(c/(1e3*60*60*24));return h>=0?h:0}tiersToShow=P(()=>{let o=this.tiers.indexOf(this.supabaseService.userTier());return this.allTiers.slice(o+1)});allTiers=[{title:"Basic",price:"Free",summary:"Initial exploration without hardware.",details:["Access to basic BCI experiments only","Essential experimental controls","<b>No hardware synchronization</b>"],note:"",amount:0,amountVerbose:"Free",tier:"Basic",button:"Start for Free"},{title:"Hobbyist",price:"for $7 per month",summary:"Monthly access for enthusiasts.",details:["Access to all BCI paradigms","Advanced experimental controls","<b>No hardware synchronization</b>","<b>Personal use only</b>"],note:"This plan does not renew automatically. Manual renewal is required each month.",amount:7,amountVerbose:"$7 / month",tier:"Hobbyist"},{title:"Researcher",price:"for $49 per year",summary:"Annual license without hardware.",details:["Access to all BCI paradigms","Advanced experimental controls","<b>No hardware synchronization</b>","<b>Personal or academic use only</b>"],note:"This plan does not include synchronization hardware. Ideal for offline or analysis-only research workflows.",amount:49,amountVerbose:"$49 / year",tier:"Researcher"},{title:"Pro",price:"for $549 per year",summary:"Full solution with hardware shipped.",details:["Access to full experiment library","<b>Includes synchronization hardware</b>","<b>Worldwide shipping included</b>","<b>Real-time event triggers</b>","<b>Research-grade deployment ready</b>"],note:"Your synchronization hardware will be shipped after purchase. Worldwide delivery included at no extra cost.",amount:549,amountVerbose:"$549 / year",tier:"Pro"},{title:"Enterprise",price:"for $3200<sup>*</sup> per year",summary:"Full access + Custom experiment.",details:["All Pro-tier features included","<b>One month of dedicated development</b>","<b>Custom paradigm design</b>","<b>Priority support & consulting</b>","<b>Tailored enterprise protocols</b>","<b>Worldwide shipping of hardware</b>"],note:"*Includes the full design and development of one (1) customized experimental paradigm tailored to your needs.",amount:3200,amountVerbose:"$3200 / year",tier:"Enterprise"}];static \u0275fac=function(e){return new(e||t)(C(j),C(U),C($))};static \u0275cmp=y({type:t,selectors:[["app-user"]],decls:2,vars:1,consts:[[1,"flex-row"],["matButton","filled",1,"logbutton",3,"click"],[1,"devicon","devicon-google-plain"],[1,"devicon","devicon-github-original"],[1,"flex-row","margin-bottom-large"],["matButton","filled",1,"error",3,"click"],[1,"margin-top-large","margin-bottom-large"],[1,"no-margin-bottom"],["multi",""],["hideToggle","",3,"expanded"],[3,"innerHTML"],[1,"paypal-container"],[1,"shipping"],[3,"amount","tier","userId","container"],["id","request",1,"no-margin-bottom"],["href","mailto:cteno@dunderlab.com"]],template:function(e,a){e&1&&u(0,me,11,0)(1,ke,20,4),e&2&&f(a.supabaseService.userLogged()?1:0)},dependencies:[B,z,H,A,N,Z,b,X,G,W,q,K,Y,V],styles:[".paypal-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:1rem}app-paypal[_ngcontent-%COMP%]{width:40%}.shipping[_ngcontent-%COMP%]{color:var(--mat-sys-error);font-weight:700}"]})};export{ee as User};
