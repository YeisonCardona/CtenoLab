import{c as Y}from"./chunk-TY5FX5HE.js";import"./chunk-4WTQCKOU.js";import{c as z,h as J,i as K,j as X,k as Z}from"./chunk-SWT26FOW.js";import"./chunk-RUMMOHDH.js";import{j as F,l as Q}from"./chunk-ULVMOL5Q.js";import"./chunk-FFC47PSI.js";import{a as R,b as j}from"./chunk-TMN5OVIN.js";import{a as U,b as q}from"./chunk-5MOYTFVM.js";import{b as $}from"./chunk-M5EJNGD7.js";import"./chunk-ZLWXODUG.js";import"./chunk-7MEONBII.js";import{b as W}from"./chunk-6AWGWZ7C.js";import"./chunk-VEDDZ7KK.js";import{b as A,c as N}from"./chunk-SDG2FXYZ.js";import"./chunk-ULZUMJKG.js";import"./chunk-HLZ76JLJ.js";import"./chunk-YXXGTQDZ.js";import{l as V,o as G}from"./chunk-LPTDMZJD.js";import{l as O,m as k}from"./chunk-RJBTUCSS.js";import{Ab as h,Bb as a,Cb as o,Db as u,Fb as g,Jb as C,Kb as s,Ob as D,Pb as H,Qb as B,Sa as l,Wb as I,Xa as f,Yb as i,Zb as L,_b as v,db as E,ga as p,ha as _,jc as x,kc as w,ra as b,ub as d,vb as m,wb as T,yb as y,zb as P}from"./chunk-TEXVEQLC.js";import{i as M}from"./chunk-5KHZBZE7.js";var ie=["taskPanel"];function ne(t,n){if(t&1){let e=g();a(0,"p"),i(1,"Using "),a(2,"strong"),i(3,"WebUSB"),o(),i(4,". This is the preferred method for communicating with supported hardware."),o(),a(5,"p",6),i(6,"Interface: "),o(),a(7,"mat-button-toggle-group",7),C("change",function(r){p(e);let S=s();return _(S.selectedInterfaceChange(r.value))}),a(8,"mat-button-toggle",8),i(9,"Auto"),o(),a(10,"mat-button-toggle",9),i(11,"0"),o(),a(12,"mat-button-toggle",10),i(13,"1"),o(),a(14,"mat-button-toggle",11),i(15,"2"),o(),a(16,"mat-button-toggle",12),i(17,"3"),o()()}if(t&2){let e=s();l(7),h("value",e.selectedInterface)}}function ae(t,n){t&1&&(a(0,"p"),i(1,"Using "),a(2,"strong"),i(3,"Web Serial API"),o(),i(4,". This is an alternative method for devices that support serial communication."),o())}function oe(t,n){if(t&1){let e=g();a(0,"button",13),C("click",function(){p(e);let r=s(2);return _(r.hardwareService.core.autoConnect())}),i(1," Auto-Connect to Hardware "),a(2,"mat-icon"),i(3,"usb"),o()()}}function re(t,n){if(t&1){let e=g();a(0,"div",5)(1,"button",13),C("click",function(){p(e);let r=s();return _(r.hardwareService.core.requestAndConnectDevice())}),i(2," Select Hardware to Connect "),a(3,"mat-icon"),i(4,"usb"),o()(),d(5,oe,4,0,"button",14),o()}if(t&2){let e=s();l(5),m(e.hardwareService.core.hasAvailableDevice()?5:-1)}}function le(t,n){if(t&1&&(a(0,"b"),i(1),o(),i(2),u(3,"br")),t&2){let e=n.$implicit;l(),v("",e.name,":"),l(),v(" ",e.value)}}function ce(t,n){if(t&1&&(i(0),x(1,"number")),t&2){let e=s(2);v(" ",w(1,1,e.hardwareService.core.latencyStats().latency*1e3,"1.0-2")," \xB5s ")}}function se(t,n){t&1&&i(0," ??? ")}function de(t,n){if(t&1&&(i(0),x(1,"number")),t&2){let e=s(2);v(" ",w(1,1,e.hardwareService.core.latencyStats().jitter*1e3,"1.0-2")," \xB5s ")}}function me(t,n){t&1&&i(0," ??? ")}function ue(t,n){if(t&1&&(i(0),x(1,"number")),t&2){let e=s(2);v(" ",w(1,1,e.hardwareService.core.latencyStats().min*1e3,"1.0-2")," \xB5s ")}}function pe(t,n){t&1&&i(0," ??? ")}function _e(t,n){if(t&1&&(i(0),x(1,"number")),t&2){let e=s(2);v(" ",w(1,1,e.hardwareService.core.latencyStats().max*1e3,"1.0-2")," \xB5s ")}}function Ce(t,n){t&1&&i(0," ??? ")}function ve(t,n){if(t&1&&(i(0),x(1,"number")),t&2){let e=s(2);v(" ",w(1,1,e.hardwareService.core.latencyStats().median*1e3,"1.0-2")," \xB5s ")}}function ge(t,n){t&1&&i(0," ??? ")}function fe(t,n){if(t&1&&i(0),t&2){let e=s(2);v(" ",e.hardwareService.core.latencyStats().samples," ")}}function xe(t,n){t&1&&i(0," ??? ")}function we(t,n){if(t&1){let e=g();a(0,"div",15)(1,"button",16),C("click",function(){p(e);let r=s();return _(r.hardwareService.core.disconnect())}),i(2," Disconnect from Hardware "),a(3,"mat-icon"),i(4,"usb_off"),o()(),a(5,"button",13),C("click",function(){p(e);let r=s();return _(r.testConnection())}),i(6," Test Connection "),o()(),a(7,"div",17)(8,"p",18),i(9,"Connection successful!"),o(),a(10,"p",19),i(11,"Connection failed!"),o()(),u(12,"mat-divider"),a(13,"p",17),y(14,le,4,2,null,null,T),o(),u(16,"mat-divider"),a(17,"div",20)(18,"button",21),C("click",function(){p(e);let r=s();return _(r.hardwareService.core.measureLatency())}),i(19," Start Latency Test "),a(20,"mat-icon"),i(21,"acute"),o()(),a(22,"p")(23,"b"),i(24,"Latency:"),o(),d(25,ce,2,4)(26,se,1,0),u(27,"br"),a(28,"b"),i(29,"Jitter:"),o(),d(30,de,2,4)(31,me,1,0),u(32,"br"),a(33,"b"),i(34,"Min:"),o(),d(35,ue,2,4)(36,pe,1,0),u(37,"br"),a(38,"b"),i(39,"Max:"),o(),d(40,_e,2,4)(41,Ce,1,0),u(42,"br"),a(43,"b"),i(44,"Median:"),o(),d(45,ve,2,4)(46,ge,1,0),u(47,"br"),a(48,"b"),i(49,"Samples:"),o(),d(50,fe,1,1)(51,xe,1,0),o()()}if(t&2){let e=s();l(8),I("active",e.successConnectedMessage()),l(2),I("active",e.failConnectedMessage()),l(4),P(e.hardwareService.core.getProperties()),l(4),h("disabled",e.hardwareService.core.measuringLatency()),l(7),m(e.hardwareService.core.latencyStats().latency>0?25:26),l(5),m(e.hardwareService.core.latencyStats().jitter>0?30:31),l(5),m(e.hardwareService.core.latencyStats().min>0?35:36),l(5),m(e.hardwareService.core.latencyStats().max>0?40:41),l(5),m(e.hardwareService.core.latencyStats().median>0?45:46),l(5),m(e.hardwareService.core.latencyStats().samples>0?50:51)}}function Se(t,n){if(t&1){let e=g();a(0,"button",24),C("click",function(){let r=p(e).$implicit,S=s(2);return _(S.onCommand(r))}),i(1),o()}if(t&2){let e=n.$implicit;l(),L(e)}}function be(t,n){if(t&1&&(u(0,"mat-divider"),a(1,"div",22),y(2,Se,2,1,"button",23,T),o()),t&2){let e=s();l(2),P(e.testCommands)}}var ee=class t{constructor(n,e,c,r,S){this.navigationService=n;this.breadcrumbService=e;this.hardwareService=c;this.supabaseService=r;this.dialog=S;n.setActiveLink("/hardware-control-panel"),this.breadcrumbService.setBreadcrumbs([{label:"Home",url:"/home"},{label:"Hardware Control Panel",url:"/hardware-control-panel"}])}taskPanel;selectedInterface="auto";successConnectedMessage=b(!1);failConnectedMessage=b(!1);devMode=window.location.hostname.startsWith("localhost");connectionType=b("serial");intervalId;timeOutId;requieredTier="Hobbyist";startTierInspection(n=3e3,e=1e3){this.timeOutId=window.setTimeout(()=>{let c=this.supabaseService.getTierLevel(this.supabaseService.userTier()),r=this.supabaseService.getTierLevel(this.requieredTier);this.intervalId=window.setInterval(()=>{c<r?this.taskPanel?.nativeElement?.classList?.add("locked"):this.taskPanel?.nativeElement?.classList?.remove("locked")},e),c<r&&this.dialog.open(J,{data:{title:"Tier Restriction!",question:`This paradigm is only available to users with the <b>${this.requieredTier}</b> plan or higher.`,confirmText:"Got it"}})},n)}ngOnInit(){let n=localStorage.getItem("cteno-hardware-connection-mode"),e=n==="usb"||n==="serial"?n:"serial";this.connectionType.set(e),this.onConnectionTypeChange(e),this.startTierInspection()}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId),this.timeOutId&&clearInterval(this.timeOutId)}selectConnectionType(n){this.connectionType.set(n),this.onConnectionTypeChange(n)}onConnectionTypeChange(n){n==="usb"&&(this.hardwareService.core.interfaceMode=this.selectedInterface),this.hardwareService.setMode(n)}selectedInterfaceChange(n){this.selectedInterface=n}testConnection(){return M(this,null,function*(){this.hardwareService.core.flushQueues(),yield this.hardwareService.core.writeLine("CMD=PING;CMD=@BIP 1000 100 128;CMD=@BRAND;");let n=yield this.hardwareService.core.readLine();this.successConnectedMessage.set(n==="RESP=PONG;"),this.failConnectedMessage.set(n!=="RESP=PONG;")})}onCommand(n){return M(this,null,function*(){yield this.hardwareService.core.writeLine(n)})}testCommands=["CMD=PING;","CMD=BIP 1000 100 128;","CMD=BRAND;","CMD=BIP;","CMD=BIP 3000;","CMD=BIP 1000 500;","CMD=BIP 2000 300 64;","CMD=BIP 2000 300 128;","CMD=BIP 2000 300 255;","CMD=CLA;",'CMD=LOG "testing log message";','CMD=LOG "testing log message" RED;','CMD=LOG "testing log message" BLUE;','CMD=LOG "testing log message" GREEN;','CMD=LOG "testing log message" CYAN;','CMD=LOG "testing log message" YELLOW;','CMD=LOG "testing log message" MAGENTA;','CMD=LOG "testing log message" ORANGE;','CMD=LOG "testing log message" PINK;','CMD=LOG "This is a long title that should wrap automatically across multiple lines if it doesnt fit.";','CMD=TITLE "This is a long title that should wrap automatically across multiple lines if it doesnt fit.";','CMD=TITLE "Unilateral Motor Imagery" BLUE;','CMD=TITLE "Unilateral Motor Imagery" RED 3;','CMD=TITLE "Motor Imagery" YELLOW 4;',`EXIT
`];static \u0275fac=function(e){return new(e||t)(f(U),f(q),f($),f(W),f(z))};static \u0275cmp=E({type:t,selectors:[["app-hardware-control-panel"]],viewQuery:function(e,c){if(e&1&&D(ie,5),e&2){let r;H(r=B())&&(c.taskPanel=r.first)}},decls:15,vars:4,consts:[["taskPanel",""],["name","connectionType","aria-label","Connection Type",3,"change","value"],["value","usb"],["value","serial"],[1,"margin-bottom-large"],[1,"flex-row","margin-bottom-large"],[1,"no-margin-bottom"],[3,"change","value"],["value","auto"],["value","0"],["value","1"],["value","2"],["value","3"],["matButton","filled",3,"click"],["matButton","filled"],[1,"flex-row"],["matButton","filled",1,"disconnect",3,"click"],[1,"margin-top-large"],[1,"success"],[1,"fail"],[1,"margin-bottom-large","margin-top-large"],["matButton","filled",3,"click","disabled"],[1,"button-row","margin-top-large"],["matButton","tonal",1,"command-button"],["matButton","tonal",1,"command-button",3,"click"]],template:function(e,c){if(e&1){let r=g();a(0,"div",null,0)(2,"h1"),i(3,"Hardware Control Panel"),o(),a(4,"mat-button-toggle-group",1),C("change",function(te){return p(r),_(c.selectConnectionType(te.value))}),a(5,"mat-button-toggle",2),i(6,"USB"),o(),a(7,"mat-button-toggle",3),i(8,"Serial"),o()(),a(9,"div",4),d(10,ne,18,1)(11,ae,5,0,"p"),o(),d(12,re,6,1,"div",5)(13,we,52,11),d(14,be,4,0),o()}e&2&&(l(4),h("value",c.hardwareService.connectionMode()),l(6),m(c.connectionType()==="usb"?10:c.connectionType()==="serial"?11:-1),l(2),m(c.hardwareService.core.isConnected()?13:12),l(2),m(c.supabaseService.userTier()==="Developer"?14:-1))},dependencies:[G,V,j,R,N,A,Q,F,k,O,Z,K,X,Y],styles:[".disconnect[_ngcontent-%COMP%]{background-color:var(--mat-sys-error)!important}.success[_ngcontent-%COMP%]{display:none}.success.active[_ngcontent-%COMP%]{display:block;color:var(--mat-sys-primary)}.fail[_ngcontent-%COMP%]{display:none}.fail.active[_ngcontent-%COMP%]{display:block;color:var(--mat-sys-error)}.button-row[_ngcontent-%COMP%]{display:flex;flex-flow:wrap;gap:8px;justify-content:space-evenly}.command-button[_ngcontent-%COMP%]{font-family:monospace;font-size:.8rem}"]})};export{ee as HardwareControlPanel};
