import{k as N,l as O,m as R,n as W,o as j,p as Y,q}from"./chunk-HLE7QZBV.js";import{f as H}from"./chunk-6LM54VFH.js";import"./chunk-ZOZSFTET.js";import{a as $,b as z}from"./chunk-7U35SQUV.js";import"./chunk-4ULVSNUU.js";import{a as M,b as g}from"./chunk-XSAIEII5.js";import"./chunk-3C6VJBNL.js";import{c as B}from"./chunk-62AV6QVL.js";import{a as F,b as L}from"./chunk-UAQ7UU4Y.js";import"./chunk-6Q6ZBUD2.js";import"./chunk-NXQCXCLR.js";import{l as D,o as A}from"./chunk-RPD344RW.js";import"./chunk-IAEIATSC.js";import{$b as U,Ab as y,Bb as r,Cb as a,Db as l,Hb as E,Lb as h,Mb as p,Pa as w,Sa as s,Xa as f,_b as t,ac as u,db as v,ec as k,ga as _,ha as x,sc as V,ub as d,vb as m,wb as I,yb as P,zb as T}from"./chunk-P6GYV7WW.js";import{j as S}from"./chunk-HVQDNULJ.js";var C=class i{constructor(n){this.supabaseService=n}amount;userId;tier;container;srcPaypal="";paypalColor="";genUniqueInvoice(){return this.tier+"-"+Math.random().toString(36).substring(2,165)}ngOnInit(){this.supabaseService.userTier()==="Developer"?(this.srcPaypal="https://www.sandbox.paypal.com/sdk/js?client-id="+M.sandbox+"&currency=USD",this.paypalColor="gold"):(this.srcPaypal="https://www.paypal.com/sdk/js?client-id="+M.production+"&currency=USD",this.paypalColor="white")}ngAfterViewInit(){return S(this,null,function*(){try{yield this.loadPayPalScript(),yield this.waitForPaypal(),paypal.Buttons({style:{layout:"horizontal",color:this.paypalColor,shape:"pill",label:"pay",tagline:!1},createOrder:(n,e)=>e.order.create({purchase_units:[{amount:{value:this.amount},custom_id:this.userId,invoice_id:this.genUniqueInvoice()}]}),onApprove:(n,e)=>S(this,null,function*(){let c=`Payment successful! Thank you, ${(yield e.order.capture()).payer.name.given_name}. Your access tier will be updated automatically in a few moments.`;["pro","researcher"].includes(this.tier.toLowerCase())&&(c+=" Hardware included in your plan will be shipped to the address specified in your PayPal account."),alert(c)})}).render("#"+this.container)}catch(n){console.error("PayPal initialization failed:",n)}return null})}loadPayPalScript(){return new Promise((n,e)=>{if(document.getElementById("paypal-sdk"))return n();let o=document.createElement("script");o.id="paypal-sdk",o.src=this.srcPaypal,o.onload=()=>n(),o.onerror=()=>e("Failed to load PayPal SDK"),document.body.appendChild(o)})}waitForPaypal(){return new Promise((n,e)=>{let o=setInterval(()=>{typeof window<"u"&&window.paypal&&this.userId&&this.userId.length>5&&(clearInterval(o),n())},50);setTimeout(()=>{clearInterval(o),e("PayPal SDK did not initialize in time.")},3e3)})}static \u0275fac=function(e){return new(e||i)(f(g))};static \u0275cmp=v({type:i,selectors:[["app-paypal"]],inputs:{amount:"amount",userId:"userId",tier:"tier",container:"container"},decls:1,vars:2,consts:[[3,"id"]],template:function(e,o){e&1&&l(0,"div",0),e&2&&y("id",k(o.container))},encapsulation:2})};function X(i,n){if(i&1){let e=E();r(0,"h1"),t(1,"Welcome, Researcher"),a(),r(2,"p"),t(3,"Please sign in with your preferred method."),a(),r(4,"div",0)(5,"button",1),h("click",function(){_(e);let c=p();return x(c.supabaseService.signInWithProvider("google"))}),l(6,"i",2),t(7," Log in using Google "),a(),r(8,"button",1),h("click",function(){_(e);let c=p();return x(c.supabaseService.signInWithProvider("github"))}),l(9,"i",3),t(10," Log in using GitHub "),a()()}}function Z(i,n){if(i&1&&(r(0,"p")(1,"b"),t(2,"License Tier:"),a(),t(3),l(4,"br"),r(5,"b"),t(6,"Issued at:"),a(),t(7),l(8,"br"),r(9,"b"),t(10,"Expires at:"),a(),t(11),l(12,"br"),r(13,"b"),t(14,"Remaining days:"),a(),t(15),l(16,"br"),a()),i&2){let e,o,c,b=p(2);s(3),u(" ",(e=b.supabaseService.userLicense())==null?null:e.tier),s(4),u(" ",(o=b.supabaseService.userLicense())==null?null:o.issued_at),s(4),u(" ",(c=b.supabaseService.userLicense())==null?null:c.expires_at),s(4),u(" ",b.getRemainingDays())}}function ee(i,n){i&1&&(r(0,"p"),t(1," Your account does not have an active license."),l(2,"br"),t(3," Please redeem or purchase a license to unlock full access. "),a())}function te(i,n){i&1&&(r(0,"p"),t(1," You are currently subscribed to the "),r(2,"strong"),t(3,"Enterprise plan"),a(),t(4," \u2014 our most advanced tier. "),l(5,"br"),t(6," You have full access to all experiments, hardware features, and dedicated support. "),a())}function ie(i,n){i&1&&(r(0,"p"),t(1,"Select the plan that best fits your needs."),a())}function ne(i,n){if(i&1&&l(0,"li",10),i&2){let e=n.$implicit;y("innerHTML",e,w)}}function ae(i,n){if(i&1&&l(0,"p",10),i&2){let e=p().$implicit;y("innerHTML",e.note,w)}}function re(i,n){i&1&&(r(0,"strong",12),t(1,"Shipping Notice:"),a(),r(2,"p"),t(3," We will use your "),r(4,"b"),t(5,"PayPal shipping address"),a(),t(6," for the delivery of any hardware included in your plan. "),l(7,"br"),t(8," Please make sure your address is "),r(9,"b"),t(10,"correct and up-to-date"),a(),t(11," before completing the payment. "),a())}function oe(i,n){if(i&1&&l(0,"app-paypal",13),i&2){let e=p(2).$implicit,o=p(2);y("amount",e.amount)("tier",e.tier)("userId",o.supabaseService.userId())("container",e.tier)}}function le(i,n){if(i&1&&(r(0,"div",11),d(1,oe,1,4,"app-paypal",13),a()),i&2){let e=p().$implicit;s(),m(e.amount>0?1:-1)}}function se(i,n){if(i&1&&(r(0,"mat-expansion-panel",9)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t(3),a(),r(4,"mat-panel-description"),t(5),a()(),r(6,"ul"),P(7,ne,1,1,"li",10,I),a(),d(9,ae,1,1,"p",10),r(10,"h3"),t(11),a(),d(12,re,12,0),d(13,le,2,1,"div",11),a()),i&2){let e=n.$implicit,o=n.$index,c=p(2);y("expanded",o===0),s(3),u(" ",e.title," "),s(2),u(" ",e.summary," "),s(2),T(e.details),s(2),m(e.note?9:-1),s(2),U(e.amountVerbose),s(),m(c.supabaseService.getTierLevel(e.tier)>=3?12:-1),s(),m(c.supabaseService.userId()?13:-1)}}function ce(i,n){i&1&&(l(0,"mat-divider"),r(1,"div",6)(2,"h3",14),t(3,"Request a Custom Experiment"),a(),r(4,"p"),t(5," If you require a specialized experimental design, I\u2019ll be happy to provide personalized support. "),l(6,"br"),t(7," Just write to me at "),r(8,"a",15),t(9,"cteno@dunderlab.com"),a(),t(10," and I\u2019ll get back to you promptly. "),a()())}function pe(i,n){if(i&1){let e=E();r(0,"h1"),t(1),a(),r(2,"p"),t(3,"You are now signed in to your researcher dashboard."),a(),r(4,"div",4)(5,"button",5),h("click",function(){_(e);let c=p();return x(c.supabaseService.signOut())}),t(6,"Sign out"),a()(),l(7,"mat-divider"),d(8,Z,17,4,"p")(9,ee,4,0,"p"),l(10,"mat-divider"),r(11,"div",6)(12,"h3",7),t(13,"Update Your Tier"),a(),d(14,te,7,0,"p")(15,ie,2,0,"p"),r(16,"mat-accordion",8),P(17,se,14,7,"mat-expansion-panel",9,I),a()(),d(19,ce,11,0)}if(i&2){let e=p();s(),u("Welcome back, ",e.supabaseService.userMail(),"!"),s(7),m(e.supabaseService.licenseActive()?8:9),s(6),m(e.supabaseService.userTier()==="Enterprise"?14:15),s(3),T(e.tiersToShow()),s(2),m(e.supabaseService.getTierLevel(e.supabaseService.userTier())>=e.supabaseService.getTierLevel("Pro")?19:-1)}}var G=class i{constructor(n,e,o){this.navigationService=n;this.breadcrumbService=e;this.supabaseService=o;n.setActiveLink("/experiments"),this.breadcrumbService.setBreadcrumbs([{label:"Home",url:"/home"},{label:"User",url:"/user"}])}userId=null;tiers=["Basic","Hobbyist","Researcher","Pro","Enterprise"];ngAfterViewInit(){}getRemainingDays(){let n=this.supabaseService.userLicense()?.expires_at,e=new Date,c=new Date(n).getTime()-e.getTime(),b=Math.ceil(c/(1e3*60*60*24));return b>=0?b:0}tiersToShow=V(()=>{let n=this.tiers.indexOf(this.supabaseService.userTier());return this.allTiers.slice(n+1)});allTiers=[{title:"Basic",price:"Free",summary:"Initial exploration without hardware.",details:["Access to basic BCI experiments only","Essential experimental controls","<b>No hardware synchronization</b>"],note:"",amount:0,amountVerbose:"Free",tier:"Basic",button:"Start for Free"},{title:"Hobbyist",price:"for $7 per month",summary:"Monthly access for enthusiasts.",details:["Access to all BCI paradigms","Advanced experimental controls","<b>No hardware synchronization</b>","<b>Personal use only</b>"],note:"This plan does not renew automatically. Manual renewal is required each month.",amount:7,amountVerbose:"$7 / month",tier:"Hobbyist"},{title:"Researcher",price:"for $49 per year",summary:"Annual license without hardware.",details:["Access to all BCI paradigms","Advanced experimental controls","<b>No hardware synchronization</b>","<b>Personal or academic use only</b>"],note:"This plan does not include synchronization hardware. Ideal for offline or analysis-only research workflows.",amount:49,amountVerbose:"$49 / year",tier:"Researcher"},{title:"Pro",price:"for $549 per year",summary:"Full solution with hardware shipped.",details:["Access to full experiment library","<b>Includes synchronization hardware</b>","<b>Worldwide shipping included</b>","<b>Real-time event triggers</b>","<b>Research-grade deployment ready</b>"],note:"Your synchronization hardware will be shipped after purchase. Worldwide delivery included at no extra cost.",amount:549,amountVerbose:"$549 / year",tier:"Pro"},{title:"Enterprise",price:"for $3200<sup>*</sup> per year",summary:"Full access + Custom experiment.",details:["All Pro-tier features included","<b>One month of dedicated development</b>","<b>Custom paradigm design</b>","<b>Priority support & consulting</b>","<b>Tailored enterprise protocols</b>","<b>Worldwide shipping of hardware</b>"],note:"*Includes the full design and development of one (1) customized experimental paradigm tailored to your needs.",amount:3200,amountVerbose:"$3200 / year",tier:"Enterprise"}];static \u0275fac=function(e){return new(e||i)(f($),f(z),f(g))};static \u0275cmp=v({type:i,selectors:[["app-user"]],decls:2,vars:1,consts:[[1,"flex-row"],["matButton","filled",1,"logbutton",3,"click"],[1,"devicon","devicon-google-plain"],[1,"devicon","devicon-github-original"],[1,"flex-row","margin-bottom-large"],["matButton","filled",1,"error",3,"click"],[1,"margin-top-large","margin-bottom-large"],[1,"no-margin-bottom"],["multi",""],["hideToggle","",3,"expanded"],[3,"innerHTML"],[1,"paypal-container"],[1,"shipping"],[3,"amount","tier","userId","container"],["id","request",1,"no-margin-bottom"],["href","mailto:cteno@dunderlab.com"]],template:function(e,o){e&1&&d(0,X,11,0)(1,pe,20,4),e&2&&m(o.supabaseService.userLogged()?1:0)},dependencies:[B,L,F,A,D,N,C,q,Y,O,R,j,W,H],styles:[".paypal-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:1rem}app-paypal[_ngcontent-%COMP%]{width:40%}.shipping[_ngcontent-%COMP%]{color:var(--mat-sys-error);font-weight:700}"]})};export{G as UserComponent};
