import{c as Y}from"./chunk-TY5FX5HE.js";import"./chunk-4WTQCKOU.js";import{c as J,h as z,i as K,j as X,k as Z}from"./chunk-SWT26FOW.js";import"./chunk-RUMMOHDH.js";import{j as F,l as Q}from"./chunk-ULVMOL5Q.js";import"./chunk-FFC47PSI.js";import{a as A,b as j}from"./chunk-TMN5OVIN.js";import{a as U,b as q}from"./chunk-5MOYTFVM.js";import{b as $}from"./chunk-3ONABWN3.js";import"./chunk-ZLWXODUG.js";import"./chunk-7MEONBII.js";import{b as W}from"./chunk-6AWGWZ7C.js";import"./chunk-VEDDZ7KK.js";import{b as N,c as R}from"./chunk-SDG2FXYZ.js";import"./chunk-ULZUMJKG.js";import"./chunk-HLZ76JLJ.js";import"./chunk-YXXGTQDZ.js";import{l as G,o as V}from"./chunk-LPTDMZJD.js";import{l as O,m as k}from"./chunk-RJBTUCSS.js";import{Ab as P,Bb as a,Cb as o,Db as p,Fb as S,Jb as f,Kb as l,Ob as H,Pb as B,Qb as D,Sa as r,Wb as I,Xa as w,Yb as i,Zb as L,_b as _,db as E,ga as x,ha as v,jc as u,kc as C,ra as g,ub as s,vb as m,wb as T,yb as y,zb as M}from"./chunk-TEXVEQLC.js";import{i as h}from"./chunk-5KHZBZE7.js";var ie=["taskPanel"];function ne(e,n){e&1&&(a(0,"p"),i(1,"Using "),a(2,"strong"),i(3,"WebUSB"),o(),i(4,". This is the preferred method for communicating with supported hardware."),o())}function ae(e,n){e&1&&(a(0,"p"),i(1,"Using "),a(2,"strong"),i(3,"Web Serial API"),o(),i(4,". This is an alternative method for devices that support serial communication."),o())}function oe(e,n){if(e&1){let t=S();a(0,"button",6),f("click",function(){x(t);let c=l(2);return v(c.hardwareService.core.autoConnect())}),i(1," Auto-Connect to Hardware "),a(2,"mat-icon"),i(3,"usb"),o()()}}function re(e,n){if(e&1){let t=S();a(0,"div",5)(1,"button",6),f("click",function(){x(t);let c=l();return v(c.hardwareService.core.requestAndConnectDevice())}),i(2," Select Hardware to Connect "),a(3,"mat-icon"),i(4,"usb"),o()(),s(5,oe,4,0,"button",7),o()}if(e&2){let t=l();r(5),m(t.hardwareService.core.hasAvailableDevice()?5:-1)}}function le(e,n){if(e&1&&(a(0,"b"),i(1),o(),i(2),p(3,"br")),e&2){let t=n.$implicit;r(),_("",t.name,":"),r(),_(" ",t.value)}}function ce(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().latency*1e3,"1.0-2")," \xB5s ")}}function de(e,n){e&1&&i(0," ??? ")}function se(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().jitter*1e3,"1.0-2")," \xB5s ")}}function me(e,n){e&1&&i(0," ??? ")}function pe(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().min*1e3,"1.0-2")," \xB5s ")}}function _e(e,n){e&1&&i(0," ??? ")}function ue(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().max*1e3,"1.0-2")," \xB5s ")}}function Ce(e,n){e&1&&i(0," ??? ")}function xe(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().median*1e3,"1.0-2")," \xB5s ")}}function ve(e,n){e&1&&i(0," ??? ")}function fe(e,n){if(e&1&&i(0),e&2){let t=l(2);_(" ",t.hardwareService.core.latencyStats().samples," ")}}function we(e,n){e&1&&i(0," ??? ")}function Se(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().latency/2*1e3,"1.0-2")," \xB5s ")}}function ge(e,n){e&1&&i(0," ??? ")}function be(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().jitter/2*1e3,"1.0-2")," \xB5s ")}}function he(e,n){e&1&&i(0," ??? ")}function Te(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().min/2*1e3,"1.0-2")," \xB5s ")}}function ye(e,n){e&1&&i(0," ??? ")}function Me(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().max/2*1e3,"1.0-2")," \xB5s ")}}function Pe(e,n){e&1&&i(0," ??? ")}function Ie(e,n){if(e&1&&(i(0),u(1,"number")),e&2){let t=l(2);_(" ",C(1,1,t.hardwareService.core.latencyStats().median/2*1e3,"1.0-2")," \xB5s ")}}function Ee(e,n){e&1&&i(0," ??? ")}function He(e,n){if(e&1&&i(0),e&2){let t=l(2);_(" ",t.hardwareService.core.latencyStats().samples," ")}}function Be(e,n){e&1&&i(0," ??? ")}function De(e,n){if(e&1){let t=S();a(0,"div",8)(1,"button",9),f("click",function(){x(t);let c=l();return v(c.hardwareService.core.disconnect())}),i(2," Disconnect from Hardware "),a(3,"mat-icon"),i(4,"usb_off"),o()(),a(5,"button",6),f("click",function(){x(t);let c=l();return v(c.testConnection())}),i(6," Test Connection "),o()(),a(7,"div",10)(8,"p",11),i(9,"Connection successful!"),o(),a(10,"p",12),i(11,"Connection failed!"),o()(),p(12,"mat-divider"),a(13,"p",10),y(14,le,4,2,null,null,T),o(),p(16,"mat-divider"),a(17,"div",13)(18,"button",14),f("click",function(){x(t);let c=l();return v(c.hardwareService.core.measureLatency())}),i(19," Start Latency Test "),a(20,"mat-icon"),i(21,"acute"),o()(),a(22,"p")(23,"b"),i(24,"Latency (RTT)"),o(),i(25," corresponds to the round-trip time measured from the moment a message is sent until a response is received, using high-precision timestamps. This is the "),a(26,"b"),i(27,"actual measured delay"),o(),i(28," and includes both transmission and return paths. "),o(),a(29,"p"),i(30," The values shown on the right represent an "),a(31,"b"),i(32,"estimated one-way latency"),o(),i(33,", calculated by dividing RTT-based measurements by two. This estimation "),a(34,"b"),i(35,"assumes symmetrical communication delay"),o(),i(36," and is provided for reference only. "),o(),a(37,"div",15)(38,"p")(39,"b"),i(40,"Latency (RTT):"),o(),s(41,ce,2,4)(42,de,1,0),p(43,"br"),a(44,"b"),i(45,"Jitter (RTT):"),o(),s(46,se,2,4)(47,me,1,0),p(48,"br"),a(49,"b"),i(50,"Min:"),o(),s(51,pe,2,4)(52,_e,1,0),p(53,"br"),a(54,"b"),i(55,"Max:"),o(),s(56,ue,2,4)(57,Ce,1,0),p(58,"br"),a(59,"b"),i(60,"Median:"),o(),s(61,xe,2,4)(62,ve,1,0),p(63,"br"),a(64,"b"),i(65,"Samples:"),o(),s(66,fe,1,1)(67,we,1,0),o(),a(68,"p")(69,"b"),i(70,"Latency:"),o(),s(71,Se,2,4)(72,ge,1,0),p(73,"br"),a(74,"b"),i(75,"Jitter:"),o(),s(76,be,2,4)(77,he,1,0),p(78,"br"),a(79,"b"),i(80,"Min:"),o(),s(81,Te,2,4)(82,ye,1,0),p(83,"br"),a(84,"b"),i(85,"Max:"),o(),s(86,Me,2,4)(87,Pe,1,0),p(88,"br"),a(89,"b"),i(90,"Median:"),o(),s(91,Ie,2,4)(92,Ee,1,0),p(93,"br"),a(94,"b"),i(95,"Samples:"),o(),s(96,He,1,1)(97,Be,1,0),o()()()}if(e&2){let t=l();r(8),I("active",t.successConnectedMessage()),r(2),I("active",t.failConnectedMessage()),r(4),M(t.hardwareService.core.getProperties()),r(4),P("disabled",t.hardwareService.core.measuringLatency()),r(23),m(t.hardwareService.core.latencyStats().latency>0?41:42),r(5),m(t.hardwareService.core.latencyStats().jitter>0?46:47),r(5),m(t.hardwareService.core.latencyStats().min>0?51:52),r(5),m(t.hardwareService.core.latencyStats().max>0?56:57),r(5),m(t.hardwareService.core.latencyStats().median>0?61:62),r(5),m(t.hardwareService.core.latencyStats().samples>0?66:67),r(5),m(t.hardwareService.core.latencyStats().latency>0?71:72),r(5),m(t.hardwareService.core.latencyStats().jitter>0?76:77),r(5),m(t.hardwareService.core.latencyStats().min>0?81:82),r(5),m(t.hardwareService.core.latencyStats().max>0?86:87),r(5),m(t.hardwareService.core.latencyStats().median>0?91:92),r(5),m(t.hardwareService.core.latencyStats().samples>0?96:97)}}function Le(e,n){if(e&1){let t=S();a(0,"button",18),f("click",function(){let c=x(t).$implicit,b=l(2);return v(b.onCommand(c))}),i(1),o()}if(e&2){let t=n.$implicit;r(),L(t)}}function Oe(e,n){if(e&1&&(p(0,"mat-divider"),a(1,"div",16),y(2,Le,2,1,"button",17,T),o()),e&2){let t=l();r(2),M(t.testCommands)}}var ee=class e{constructor(n,t,d,c,b){this.navigationService=n;this.breadcrumbService=t;this.hardwareService=d;this.supabaseService=c;this.dialog=b;n.setActiveLink("/hardware-control-panel"),this.breadcrumbService.setBreadcrumbs([{label:"Home",url:"/home"},{label:"Hardware Control Panel",url:"/hardware-control-panel"}])}taskPanel;selectedInterface="auto";successConnectedMessage=g(!1);failConnectedMessage=g(!1);devMode=window.location.hostname.startsWith("localhost");connectionType=g("serial");intervalId;timeOutId;requieredTier="Hobbyist";startTierInspection(n=3e3,t=1e3){this.timeOutId=window.setTimeout(()=>{let d=this.supabaseService.getTierLevel(this.supabaseService.userTier()),c=this.supabaseService.getTierLevel(this.requieredTier);this.intervalId=window.setInterval(()=>{d<c?this.taskPanel?.nativeElement?.classList?.add("locked"):this.taskPanel?.nativeElement?.classList?.remove("locked")},t),d<c&&this.dialog.open(z,{data:{title:"Tier Restriction!",question:`This paradigm is only available to users with the <b>${this.requieredTier}</b> plan or higher.`,confirmText:"Got it"}})},n)}ngOnInit(){let n=localStorage.getItem("cteno-hardware-connection-mode"),t=n==="usb"||n==="serial"?n:"serial";this.connectionType.set(t),this.onConnectionTypeChange(t),this.startTierInspection()}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId),this.timeOutId&&clearInterval(this.timeOutId)}selectConnectionType(n){this.connectionType.set(n),this.onConnectionTypeChange(n)}onConnectionTypeChange(n){this.hardwareService.setMode(n)}testConnection(){return h(this,null,function*(){this.hardwareService.core.flushQueues(),yield this.hardwareService.core.writeLine("CMD=PING;CMD=@BIP 1000 100 128;CMD=@BRAND;");let n=yield this.hardwareService.core.readLine();this.successConnectedMessage.set(n==="RESP=PONG;"),this.failConnectedMessage.set(n!=="RESP=PONG;")})}onCommand(n){return h(this,null,function*(){yield this.hardwareService.core.writeLine(n)})}testCommands=["CMD=PING;","CMD=BIP 1000 100 128;","CMD=BRAND;","CMD=BIP;","CMD=BIP 3000;","CMD=BIP 1000 500;","CMD=BIP 2000 300 64;","CMD=BIP 2000 300 128;","CMD=BIP 2000 300 255;","CMD=CLA;",'CMD=LOG "testing log message";','CMD=LOG "testing log message" RED;','CMD=LOG "testing log message" BLUE;','CMD=LOG "testing log message" GREEN;','CMD=LOG "testing log message" CYAN;','CMD=LOG "testing log message" YELLOW;','CMD=LOG "testing log message" MAGENTA;','CMD=LOG "testing log message" ORANGE;','CMD=LOG "testing log message" PINK;','CMD=LOG "This is a long title that should wrap automatically across multiple lines if it doesnt fit.";','CMD=TITLE "This is a long title that should wrap automatically across multiple lines if it doesnt fit.";','CMD=TITLE "Unilateral Motor Imagery" BLUE;','CMD=TITLE "Unilateral Motor Imagery" RED 3;','CMD=TITLE "Motor Imagery" YELLOW 4;',`EXIT
`];static \u0275fac=function(t){return new(t||e)(w(U),w(q),w($),w(W),w(J))};static \u0275cmp=E({type:e,selectors:[["app-hardware-control-panel"]],viewQuery:function(t,d){if(t&1&&H(ie,5),t&2){let c;B(c=D())&&(d.taskPanel=c.first)}},decls:15,vars:4,consts:[["taskPanel",""],["name","connectionType","aria-label","Connection Type",3,"change","value"],["value","usb"],["value","serial"],[1,"margin-bottom-large"],[1,"flex-row","margin-bottom-large"],["matButton","filled",3,"click"],["matButton","filled"],[1,"flex-row"],["matButton","filled",1,"disconnect",3,"click"],[1,"margin-top-large"],[1,"success"],[1,"fail"],[1,"margin-bottom-large","margin-top-large"],["matButton","filled",3,"click","disabled"],[1,"grid-responsive-2"],[1,"button-row","margin-top-large"],["matButton","tonal",1,"command-button"],["matButton","tonal",1,"command-button",3,"click"]],template:function(t,d){if(t&1){let c=S();a(0,"div",null,0)(2,"h1"),i(3,"Hardware Control Panel"),o(),a(4,"mat-button-toggle-group",1),f("change",function(te){return x(c),v(d.selectConnectionType(te.value))}),a(5,"mat-button-toggle",2),i(6,"USB"),o(),a(7,"mat-button-toggle",3),i(8,"Serial"),o()(),a(9,"div",4),s(10,ne,5,0,"p")(11,ae,5,0,"p"),o(),s(12,re,6,1,"div",5)(13,De,98,17),s(14,Oe,4,0),o()}t&2&&(r(4),P("value",d.hardwareService.connectionMode()),r(6),m(d.connectionType()==="usb"?10:d.connectionType()==="serial"?11:-1),r(2),m(d.hardwareService.core.isConnected()?13:12),r(2),m(d.supabaseService.userTier()==="Developer"?14:-1))},dependencies:[V,G,j,A,R,N,Q,F,k,O,Z,K,X,Y],styles:[".disconnect[_ngcontent-%COMP%]{background-color:var(--mat-sys-error)!important}.success[_ngcontent-%COMP%]{display:none}.success.active[_ngcontent-%COMP%]{display:block;color:var(--mat-sys-primary)}.fail[_ngcontent-%COMP%]{display:none}.fail.active[_ngcontent-%COMP%]{display:block;color:var(--mat-sys-error)}.button-row[_ngcontent-%COMP%]{display:flex;flex-flow:wrap;gap:8px;justify-content:space-evenly}.command-button[_ngcontent-%COMP%]{font-family:monospace;font-size:.8rem}"]})};export{ee as HardwareControlPanel};
