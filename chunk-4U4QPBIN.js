import{a as O,c as D,d as P}from"./chunk-C5MP6677.js";import{b as I,c as T}from"./chunk-62AV6QVL.js";import{b as k}from"./chunk-7J34S6W5.js";import{a as x,b as S,c as _}from"./chunk-IUODOC7G.js";import{Ab as M,Bb as l,Cb as c,Mb as R,Sa as n,Yb as y,_b as C,ac as H,db as w,hb as v,ra as g,ua as p,wb as b,yb as L,zb as F}from"./chunk-P6GYV7WW.js";import{i as f,j as u}from"./chunk-HVQDNULJ.js";function $(s,e){if(s&1&&(l(0,"mat-grid-tile")(1,"mat-icon",2),C(2),c()()),s&2){let i=e.$implicit,t=e.$index,a=R();n(),y("visible",a.showIcon()[i.class])("mirror",t===0||t===3),n(),H("",i.value," ")}}var B=class s extends D{cues=[{class:"Left Hand",value:"back_hand"},{class:"Right Hand",value:"back_hand"},{class:"Left Foot",value:"barefoot"},{class:"Right Foot",value:"barefoot"}];showIcon=g(Object.fromEntries(this.cues.map(e=>[e.class,!1])));fullWindowLink="/experiments/motor-imagery/bilateral/stimuli";normalWindowLink="/experiments/motor-imagery/bilateral";startCountdownValue=5;ngOnInit(){return u(this,null,function*(){f(s.prototype,this,"ngOnInit").call(this),yield this.hardwareService.writeLine("CMD=@CLA;"),yield this.hardwareService.writeLine('CMD=@TITLE "Bilateral Motor Imagery" CYAN 3;')})}generateTrials(){this.hardwareService.writeLine("CMD=@CLA;");let e=[];for(let i of this.experimentConfig.classes)for(let t=0;t<this.experimentConfig.trials_per_class;t++)e.push({class:i,duration:this.experimentConfig.stimulus_duration,soa:this.getRandomSoa(this.experimentConfig.soa)});return e=this.shuffle(e),e}showTrial(e){switch(e){case"Left Hand":this.showIcon.set({"Left Hand":!0,"Right Hand":!1,"Left Foot":!1,"Right Foot":!1});break;case"Right Hand":this.showIcon.set({"Left Hand":!1,"Right Hand":!0,"Left Foot":!1,"Right Foot":!1});break;case"Both Hands":this.showIcon.set({"Left Hand":!0,"Right Hand":!0,"Left Foot":!1,"Right Foot":!1});break;case"Both Feet":this.showIcon.set({"Left Hand":!1,"Right Hand":!1,"Left Foot":!0,"Right Foot":!0});break;case"Left Hand + Right Foot":this.showIcon.set({"Left Hand":!0,"Right Hand":!1,"Left Foot":!1,"Right Foot":!0});break;case"Right Hand + Left Foot":this.showIcon.set({"Left Hand":!1,"Right Hand":!0,"Left Foot":!0,"Right Foot":!1});break;case"Rest":this.showIcon.set({"Left Hand":!1,"Right Hand":!1,"Left Foot":!1,"Right Foot":!1});break;case null:this.showIcon.set({"Left Hand":!1,"Right Hand":!1,"Left Foot":!1,"Right Foot":!1});break}}stopStimuliSequence(){this.showTrial(null)}runStimuliSequence(){let e=this.generateTrials(),i=performance.now(),t=0,a=[],m=()=>{a.forEach(o=>window.clearTimeout(o)),a=[]},h=()=>{if(t>=e.length){m(),this.onDelivery.set(!1);return}let o=e[t],E=i+e.slice(0,t).reduce((r,d)=>r+d.duration+d.soa,0),G=Math.max(0,E-performance.now()),N=window.setTimeout(()=>{this.hardwareService.writeLine(`CMD=@LOG "${o.class}" BLUE;`),this.showTrial(o.class);let r=window.setTimeout(()=>{this.hardwareService.writeLine('CMD=@LOG "End" RED;'),this.showTrial(null),t++,this.setProgress(100*t/e.length),h()},o.duration);a.push(r)},G);a.push(N)};return h(),m}static \u0275fac=(()=>{let e;return function(t){return(e||(e=p(s)))(t||s)}})();static \u0275cmp=w({type:s,selectors:[["app-stimuli"]],features:[v],decls:4,vars:1,consts:[[3,"hostRef"],["cols","2","rowHeight","50%",1,"center"],[1,"cue","conditional-visible"]],template:function(i,t){i&1&&(l(0,"app-stimuli-layout",0)(1,"mat-grid-list",1),L(2,$,3,5,"mat-grid-tile",null,b),c()()),i&2&&(M("hostRef",t),n(2),F(t.cues))},dependencies:[T,I,O,k,_,S,x,P],styles:[".cue[_ngcontent-%COMP%]{color:var(--mat-sys-primary);width:1em;height:1em;font-size:20vh}mat-grid-list[_ngcontent-%COMP%]{width:70vh;height:70vh}.conditional-visible[_ngcontent-%COMP%]{visibility:visible;opacity:.3;transform:scale(1);transition:opacity .3s ease,visibility .3s ease,transform .3s ease}.conditional-visible.mirror[_ngcontent-%COMP%]{transform:scale(1) rotateY(180deg)}.conditional-visible.visible[_ngcontent-%COMP%]{visibility:visible;opacity:1;transform:scale(1.2)}.conditional-visible.visible.mirror[_ngcontent-%COMP%]{transform:scale(1.2) rotateY(180deg)}"]})};export{B as a};
